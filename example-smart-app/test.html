<script>
function uuidv4() {
  return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
    (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
  );
}
async function loginUserWitOauth(){
//	let code=this.urlParams.get('code');
	let state=uuidv4();
  console.log("state="+state)
  console.log("this.redirectURI="+this.redirectURI)
  code=null;

	if (code == null){
		href="https://"+this.domain+".auth."+this.region+".amazoncognito.com/oauth2/authorize?response_type=code&state="+state+"&client_id="+this.appClientId+"&redirect_uri="+this.redirectURI+"&scope=openid"
    console.log("location="+href);
    await fetch(href,{
		method: 'post',	
		headers:{
			'Content-Type': 'application/json'
		}
		}).then(response=>{console.log(response.json);})
	}else {
		await fetch("https://"+this.domain+".auth."+this.region+".amazoncognito.com/oauth2/authorize?response_type=authorization_code&code="+code+"&client_id="+this.appClientId+"&redirect_uri="+this.redirectURI,{
		method: 'post',	
		headers:{
			'Content-Type': 'application/x-www-form-urlencoded'
		}
		})
		.then ( (response) =>{
    console.log(response.json);
		return response.json();
		})
		.then ((data)=>{
			this.tokens=data;
			this.authService.accessToken=data.access_token;
			this.authService.refreshToken=data.refresh_token;
			//this.authService.getCurrentUserDetails().subscribe((profile:any) => { 
			//	console.log(profile);
				//this.authService.username=profile.firstName+" " +profile.lastName;
				//this.router.navigateByURL("/tabs");
			//});
		});
	}//end else
 }
this.domain="accounts-phrqltest";
this.region="us-west-2";
this.state="";
this.appClientId="118a1qur3i4k7jpf4drf2nd7v7";
this.redirectURI="https://local.phrqltest.com:4200/userpool/callback/&scope=openid"

loginUserWitOauth()
</script>
<div id="myDiv">

</div>
